Version 4
SHEET 1 1668 1472
WIRE 1040 -848 -48 -848
WIRE 992 -752 224 -752
WIRE 944 -672 304 -672
WIRE 992 -672 944 -672
WIRE 944 -576 944 -672
WIRE 784 -512 784 -528
WIRE 784 -512 704 -512
WIRE 784 -496 784 -512
WIRE 944 -432 944 -512
WIRE -144 -416 -144 -528
WIRE -48 -416 -48 -848
WIRE -48 -416 -144 -416
WIRE 304 -384 304 -672
WIRE 304 -384 32 -384
WIRE 384 -384 304 -384
WIRE 784 -384 784 -432
WIRE 784 -384 560 -384
WIRE 864 -384 784 -384
WIRE -48 -368 -48 -416
WIRE 784 -336 784 -384
WIRE 864 -336 864 -384
WIRE 1152 -336 1136 -336
WIRE -576 -320 -624 -320
WIRE -496 -320 -576 -320
WIRE -400 -320 -496 -320
WIRE 384 -320 384 -384
WIRE 560 -320 560 -384
WIRE 128 -304 -48 -304
WIRE 352 -288 320 -288
WIRE 448 -288 448 -320
WIRE 448 -288 416 -288
WIRE 528 -288 496 -288
WIRE 608 -288 608 -432
WIRE 608 -288 592 -288
WIRE 624 -288 608 -288
WIRE 1136 -288 1136 -336
WIRE 32 -272 32 -384
WIRE -704 -256 -704 -320
WIRE -576 -256 -576 -320
WIRE -496 -256 -496 -320
WIRE 496 -256 496 -288
WIRE 1072 -240 992 -240
WIRE 224 -224 224 -672
WIRE 224 -224 128 -224
WIRE 368 -224 368 -256
WIRE 368 -224 224 -224
WIRE 544 -224 544 -256
WIRE 784 -224 784 -272
WIRE 784 -224 544 -224
WIRE 864 -224 864 -272
WIRE 864 -224 784 -224
WIRE 400 -192 400 -256
WIRE 576 -192 576 -256
WIRE 944 -192 944 -432
WIRE 944 -192 576 -192
WIRE -704 -160 -704 -176
WIRE -576 -160 -576 -192
WIRE -576 -160 -704 -160
WIRE -496 -160 -496 -192
WIRE -496 -160 -576 -160
WIRE -400 -160 -496 -160
WIRE 704 -160 704 -512
WIRE 704 -160 544 -160
WIRE -704 -144 -704 -160
WIRE 32 -144 32 -192
WIRE 400 -144 32 -144
WIRE -576 -128 -576 -160
WIRE -496 -128 -496 -160
WIRE 864 -128 864 -144
WIRE 864 -128 576 -128
WIRE 368 -96 368 -160
WIRE 400 -96 400 -144
WIRE 544 -96 544 -160
WIRE 576 -96 576 -128
WIRE 336 -64 320 -64
WIRE 352 -64 336 -64
WIRE 448 -64 448 -96
WIRE 448 -64 416 -64
WIRE 528 -64 496 -64
WIRE 624 -64 592 -64
WIRE 496 -32 496 -64
WIRE -704 0 -704 -64
WIRE -576 0 -576 -64
WIRE -576 0 -624 0
WIRE -496 0 -496 -64
WIRE -496 0 -576 0
WIRE -400 0 -496 0
WIRE -16 32 -64 32
WIRE 32 32 32 16
WIRE 32 32 -16 32
WIRE 384 32 384 -32
WIRE 384 32 32 32
WIRE 560 32 560 -32
WIRE 864 32 864 -48
WIRE 864 32 560 32
WIRE 992 32 992 -240
WIRE 992 32 864 32
WIRE 992 48 992 32
WIRE 336 80 336 -64
WIRE 736 160 -112 160
WIRE 784 160 736 160
WIRE 992 160 992 128
WIRE 992 160 864 160
WIRE 400 240 320 240
WIRE 560 240 496 240
WIRE 400 288 272 288
WIRE 720 288 496 288
WIRE 816 288 720 288
WIRE 976 288 896 288
WIRE 208 336 192 336
WIRE 272 400 272 384
WIRE 272 400 -16 400
WIRE 976 400 976 368
WIRE 976 400 944 400
WIRE 192 512 192 336
WIRE 688 544 560 544
WIRE 384 592 192 592
WIRE 384 656 384 592
WIRE 560 656 560 544
WIRE 352 688 320 688
WIRE 448 688 448 656
WIRE 448 688 416 688
WIRE 528 688 496 688
WIRE 608 688 608 512
WIRE 608 688 592 688
WIRE 624 688 608 688
WIRE 496 720 496 688
WIRE -16 752 -16 400
WIRE 368 752 368 720
WIRE 368 752 -16 752
WIRE 544 752 544 720
WIRE 688 752 688 544
WIRE 688 752 544 752
WIRE 848 752 688 752
WIRE 960 752 848 752
WIRE 1040 752 960 752
WIRE -112 784 -112 160
WIRE 400 784 400 720
WIRE 400 784 -112 784
WIRE 576 784 576 720
WIRE 720 784 720 288
WIRE 720 784 576 784
WIRE 368 816 -112 816
WIRE 848 816 848 752
WIRE 848 816 544 816
WIRE 400 848 192 848
WIRE 720 848 576 848
WIRE 368 880 368 816
WIRE 400 880 400 848
WIRE 544 880 544 816
WIRE 576 880 576 848
WIRE 336 912 320 912
WIRE 352 912 336 912
WIRE 448 912 448 880
WIRE 448 912 416 912
WIRE 528 912 496 912
WIRE 624 912 592 912
WIRE 720 928 720 848
WIRE 864 928 720 928
WIRE 496 944 496 912
WIRE 560 1024 560 944
WIRE 688 1024 560 1024
WIRE 192 1040 192 848
WIRE 384 1040 384 944
WIRE 384 1040 192 1040
WIRE 864 1072 864 928
WIRE 992 1072 864 1072
WIRE 384 1088 384 1040
WIRE 432 1088 384 1088
WIRE 496 1088 432 1088
WIRE 336 1104 336 912
WIRE -112 1152 -112 816
WIRE 464 1152 -112 1152
WIRE 688 1152 688 1088
WIRE 688 1152 464 1152
WIRE 544 1168 528 1168
WIRE 528 1216 528 1168
WIRE 688 1232 688 1152
WIRE 464 1264 464 1152
FLAG 1200 -496 0
FLAG -400 0 -12V
IOPIN -400 0 Out
FLAG -400 -320 +12V
IOPIN -400 -320 Out
FLAG 1200 -576 signal
IOPIN 1200 -576 Out
FLAG 496 -256 +12V
FLAG 624 -288 -12V
FLAG 448 -320 -12V
FLAG 320 -288 +12V
FLAG 448 -96 +12V
FLAG 320 -64 -12V
FLAG 496 -32 -12V
FLAG 624 -64 +12V
FLAG 784 -608 0
FLAG 1040 -848 signal
IOPIN 1040 -848 In
FLAG -144 -608 0
FLAG 496 720 +12V
FLAG 624 688 -12V
FLAG 448 656 -12V
FLAG 320 688 +12V
FLAG 448 880 +12V
FLAG 496 944 -12V
FLAG 624 912 +12V
FLAG 400 -192 0
FLAG 736 224 0
FLAG 320 240 +12V
FLAG -16 320 0
FLAG 944 400 0
FLAG 1040 752 envelop
IOPIN 1040 752 Out
FLAG 560 240 +12V
FLAG 992 912 0
FLAG 992 1232 +12V
FLAG 752 1152 +12V
FLAG 848 1232 0
FLAG 544 1168 +12V
FLAG 528 1456 0
FLAG 320 912 -12V
FLAG 496 1088 gate
IOPIN 496 1088 Out
FLAG 368 -160 0
FLAG -64 32 buffered_out
IOPIN -64 32 Out
FLAG 1152 -336 +12V
FLAG 1136 -48 0
FLAG 608 -496 0
FLAG 272 80 0
FLAG 608 448 0
FLAG 272 1104 0
FLAG -48 -224 0
FLAG 1024 -432 0
FLAG -16 112 0
FLAG 960 832 0
FLAG 432 1008 0
FLAG -400 -160 0
SYMBOL Opamps/LT1058A 320 -288 R270
SYMATTR InstName U1
SYMBOL Opamps/LT1058A 496 -288 R270
SYMATTR InstName U3
SYMBOL voltage -704 -272 R0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage -704 -160 R0
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL voltage 1200 -592 R0
WINDOW 3 24 38 Left 2
SYMATTR Value wavefile=sample.wav
SYMATTR InstName V3
SYMATTR Value2 AC 1 0
SYMBOL Opamps/LT1058A 624 -64 R90
SYMATTR InstName U2
SYMBOL Opamps/LT1058A 448 -64 R90
SYMATTR InstName U4
SYMBOL res 112 -320 R0
SYMATTR InstName R1
SYMATTR Value 4.7k
SYMBOL res 208 -768 R0
SYMATTR InstName R2
SYMATTR Value 2k
SYMBOL diode 800 -272 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL diode 800 -432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL res 768 -624 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res -160 -624 R0
SYMATTR InstName R7
SYMATTR Value 1Meg
SYMBOL cap -64 -368 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL cap 848 -336 R0
SYMATTR InstName C3
SYMATTR Value 33p
SYMBOL res 976 -768 R0
SYMATTR InstName R8
SYMATTR Value {gain}
SYMBOL res 848 -240 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 848 -144 R0
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res 976 32 R0
SYMATTR InstName R11
SYMATTR Value {sens}
SYMBOL res 880 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL Opamps/LT1058A 448 912 R90
SYMATTR InstName U5
SYMBOL Opamps/LT1058A 624 912 R90
SYMATTR InstName U6
SYMBOL Opamps/LT1058A 496 688 R270
SYMATTR InstName U7
SYMBOL Opamps/LT1058A 320 688 R270
SYMATTR InstName U8
SYMBOL cap 720 160 R0
SYMATTR InstName C2
SYMATTR Value 10µ
SYMBOL res 176 496 R0
SYMATTR InstName R3
SYMATTR Value 100
SYMBOL npn 208 288 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL lcr-0203 448 208 R0
SYMATTR InstName X1
SYMBOL res -32 304 R0
SYMATTR InstName R4
SYMATTR Value 470
SYMBOL res 960 272 R0
SYMATTR InstName R5
SYMATTR Value {env_lv}
SYMBOL res 976 976 R0
SYMATTR InstName R13
SYMATTR Value {thr_r}
SYMBOL res 976 1056 R0
SYMATTR InstName R14
SYMATTR Value {thr_l}
SYMBOL res 976 1136 R0
SYMATTR InstName R15
SYMATTR Value 100
SYMBOL diode 672 1024 R0
SYMATTR InstName D3
SYMBOL cap 752 1136 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 200n
SYMBOL res 784 1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {release}
SYMBOL npn 464 1216 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 512 1360 R0
SYMATTR InstName R17
SYMATTR Value 4.7k
SYMBOL LED 512 1312 R0
SYMATTR InstName D4
SYMBOL res 16 -80 R0
SYMATTR InstName R18
SYMATTR Value {buf_lv}
SYMBOL res 16 -160 R0
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL res 16 -288 R0
SYMATTR InstName R20
SYMATTR Value 2k
SYMBOL npn 1072 -288 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res 1120 -144 R0
SYMATTR InstName R21
SYMATTR Value 4.7k
SYMBOL LED 1120 -192 R0
SYMATTR InstName D5
SYMBOL cap 592 -496 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMBOL cap 336 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 0.1µ
SYMBOL cap 592 448 R0
SYMATTR InstName C7
SYMATTR Value 0.1µ
SYMBOL cap 336 1088 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 0.1µ
SYMBOL diode -560 -192 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMBOL diode -560 -64 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMBOL res -64 -320 R0
SYMATTR InstName R22
SYMATTR Value 1Meg
SYMBOL res 912 304 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R23
SYMATTR Value 20
SYMBOL res 1040 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 47k
SYMBOL cap 928 -576 R0
SYMATTR InstName C11
SYMATTR Value 0.1µ
SYMBOL res -32 16 R0
SYMATTR InstName R25
SYMATTR Value 100k
SYMBOL res 944 736 R0
SYMATTR InstName R26
SYMATTR Value 100k
SYMBOL res 416 992 R0
SYMATTR InstName R27
SYMATTR Value 100k
SYMBOL res -720 -304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R28
SYMATTR Value 22
SYMBOL res -608 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 22
SYMBOL cap -512 -256 R0
SYMATTR InstName C12
SYMATTR Value 22µ
SYMBOL cap -512 -128 R0
SYMATTR InstName C13
SYMATTR Value 22µ
SYMBOL res 864 1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 1k
SYMBOL res 976 896 R0
SYMATTR InstName R31
SYMATTR Value 100
TEXT -776 248 Left 2 !.tran 800m\n;.ac oct 100 10 40k\n.param gain 7*4.7k\n.param sens 5k\n.param env_lv 1k\n;.step param env_lv list 1 300 1k\n.param buf_lv 1k\n.param threshold 0.8\n;.step param threshold list 0 0.2 0.4 0.6 0.8 1\n.param thr_l (1-{threshold})*1k+1\n.param thr_r ({threshold})*1k+1\n.param release 250k
TEXT 1104 96 Left 2 ;sens:B10k
TEXT 1112 -712 Left 2 ;gain:A1M
TEXT 1120 960 Left 2 ;threshold:1k
TEXT 1128 344 Left 2 ;envelop_sens:A1k
TEXT -104 -40 Left 2 ;buf_lv:2k
TEXT 728 1328 Left 2 ;release:500k
